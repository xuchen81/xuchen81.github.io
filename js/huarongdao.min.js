$(function(){var a=new URLSearchParams(window.location.search),b=parseInt(a.get("l"))||1,c=parseInt(6),e=750,f=1e3,g="#282c2d",h=d3.select("#canvas").append("svg").attr("width",f).attr("height",1e3),k=3,l=10,m="red",n=[[{sx:1,sy:1,width:1,height:2},{sx:2,sy:1,width:2,height:1},{sx:3,sy:2,width:2,height:1},{sx:5,sy:2,width:1,height:2},{sx:3,sy:3,width:1,height:2},{sx:4,sy:3,width:1,height:3},{sx:1,sy:4,width:2,height:1},{sx:5,sy:4,width:2,height:1},{sx:1,sy:5,width:3,height:1},{sx:1,sy:6,width:3,height:1},{sx:1,sy:3,width:2,height:1,fill:m}],[{sx:1,sy:1,width:1,height:3},{sx:2,sy:1,width:1,height:3},{sx:3,sy:1,width:1,height:2},{sx:4,sy:1,width:1,height:2},{sx:5,sy:1,width:2,height:1},{sx:3,sy:3,width:2,height:1,fill:m},{sx:5,sy:3,width:1,height:2},{sx:1,sy:4,width:2,height:1},{sx:1,sy:5,width:2,height:1},{sx:1,sy:6,width:2,height:1},{sx:3,sy:6,width:2,height:1},{sx:5,sy:5,width:1,height:2}],[{sx:1,sy:1,width:2,height:1},{sx:3,sy:1,width:1,height:2},{sx:6,sy:1,width:1,height:3},{sx:1,sy:2,width:1,height:2},{sx:2,sy:2,width:1,height:2},{sx:5,sy:2,width:1,height:2},{sx:3,sy:3,width:2,height:1,fill:m},{sx:1,sy:4,width:1,height:2},{sx:2,sy:4,width:2,height:1},{sx:4,sy:4,width:1,height:2},{sx:5,sy:4,width:2,height:1},{sx:2,sy:5,width:1,height:2},{sx:4,sy:6,width:3,height:1}],[{sx:1,sy:1,width:3,height:1},{sx:1,sy:2,width:3,height:1},{sx:4,sy:1,width:1,height:2},{sx:5,sy:1,width:1,height:2},{sx:6,sy:1,width:1,height:2},{sx:1,sy:3,width:2,height:1,fill:m},{sx:3,sy:3,width:1,height:2},{sx:6,sy:3,width:1,height:2},{sx:1,sy:4,width:2,height:1},{sx:1,sy:5,width:1,height:2},{sx:3,sy:5,width:1,height:2},{sx:5,sy:5,width:2,height:1}],[{sx:1,sy:1,width:3,height:1},{sx:4,sy:1,width:1,height:3},{sx:6,sy:1,width:1,height:2},{sx:1,sy:2,width:1,height:2},{sx:2,sy:2,width:2,height:1},{sx:2,sy:3,width:2,height:1,fill:m},{sx:5,sy:3,width:1,height:2},{sx:6,sy:3,width:1,height:2},{sx:1,sy:4,width:2,height:1},{sx:3,sy:4,width:2,height:1},{sx:3,sy:5,width:1,height:2},{sx:4,sy:5,width:3,height:1},{sx:4,sy:6,width:3,height:1}],[{sx:1,sy:1,width:1,height:3},{sx:2,sy:1,width:1,height:3},{sx:3,sy:1,width:2,height:1},{sx:5,sy:1,width:2,height:1},{sx:3,sy:2,width:2,height:1},{sx:6,sy:2,width:1,height:3},{sx:3,sy:3,width:2,height:1,fill:m},{sx:5,sy:3,width:1,height:2},{sx:2,sy:4,width:2,height:1},{sx:4,sy:4,width:1,height:2},{sx:3,sy:5,width:1,height:2},{sx:5,sy:5,width:2,height:1},{sx:1,sy:6,width:2,height:1}],[{sx:3,sy:1,width:1,height:2},{sx:4,sy:1,width:3,height:1},{sx:4,sy:2,width:1,height:2},{sx:5,sy:2,width:2,height:1},{sx:2,sy:3,width:2,height:1,fill:m},{sx:2,sy:4,width:1,height:2},{sx:3,sy:4,width:2,height:1},{sx:5,sy:4,width:1,height:3},{sx:3,sy:5,width:2,height:1},{sx:1,sy:6,width:2,height:1},{sx:3,sy:6,width:2,height:1}],[{sx:1,sy:1,width:1,height:2},{sx:3,sy:1,width:1,height:3},{sx:5,sy:1,width:2,height:1},{sx:5,sy:2,width:1,height:2},{sx:6,sy:2,width:1,height:3},{sx:1,sy:3,width:2,height:1,fill:m},{sx:2,sy:4,width:1,height:2},{sx:3,sy:4,width:3,height:1},{sx:1,sy:5,width:1,height:2},{sx:4,sy:5,width:1,height:2},{sx:5,sy:5,width:2,height:1},{sx:2,sy:6,width:2,height:1}]],o=b>n.length?n[0]:n[b-1],p=o.map(function(a){return a.direction=a.width>a.height?"x":"y",a}),q=10;h.append("rect").attr("x",(f-e)/2).attr("y",q/2).attr("rx",10).attr("ry",10).attr("width",e).attr("height",e).attr("fill","#9c6017").attr("stroke-width",q).attr("stroke","#9c6017");for(var r=[],s=0;s<c;s++)for(var d=0;d<c;d++){var t=d*e/c+(f-e)/2,u=s*e/c+q/2;r.push({x:t,y:u,width:e/c,height:e/c,fill:g,stroke:"#9c6017",posn:s+"_"+d,id:"s_"+s+"_"+d,class:"spot"})}h.selectAll("rect[class='spot']").data(r).enter().append("rect").attr("x",function(a){return a.x}).attr("rx",10).attr("ry",10).attr("y",function(a){return a.y}).attr("width",function(a){return a.width}).attr("height",function(a){return a.height}).attr("fill",function(a){return a.fill}).attr("posn",function(a){return a.posn}).attr("stroke","#9c6017").attr("stroke-width",3).attr("id",function(a){return"s_"+a.posn}).attr("covered","no");h.append("rect").attr("x",c*e/c+(f-e)/2).attr("rx",10).attr("ry",10).attr("y",(k-1)*e/c+q/2).attr("width",100).attr("height",e/c).attr("fill",g),h.selectAll("rect[class='block']").data(p).enter().append("rect").attr("x",function(a){return(a.sx-1)*e/c+(f-e)/2+l}).attr("y",function(a){return(a.sy-1)*e/c+q/2+l}).attr("rx",10).attr("ry",10).attr("width",function(a){return a.width*e/c-2*l}).attr("height",function(a){return a.height*e/c-2*l}).attr("block-width",function(a){return a.width}).attr("block-height",function(a){return a.height}).attr("fill",function(a){return a.fill||"orange"}).attr("curry",function(a){return a.sy-1}).attr("currx",function(a){return a.sx-1}).attr("posn",function(a){return a.sy-1+"_"+(a.sx-1)}).attr("stroke","#9c6017").attr("stroke-width",3).attr("class","block").attr("id",function(a){return a.fill?"target":""});for(var v=d3.select("#target").attr("block-width"),w=k-1,x=c-v,s=0;s<p.length;s++){if(1<p[s].width)for(var d=0;d<p[s].width;d++)d3.select("#s_"+(p[s].sy-1)+"_"+(p[s].sx-1+d)).attr("covered","yes");if(1<p[s].height)for(var d=0;d<p[s].height;d++)d3.select("#s_"+(p[s].sy-1+d)+"_"+(p[s].sx-1)).attr("covered","yes")}var y=function(){return d3.select("#target").attr("posn")===w+"_"+x},z=function(a,b,d,g,i){var j,k,m=[],n=[];if("left"===i){j=a;for(var o=b-2;0<=o&&"no"===d3.select("#s_"+a+"_"+o).attr("covered");)o-=1;k=o+1}if("right"===i){j=a;for(var p=b+d-1+2;p<c&&"no"===d3.select("#s_"+a+"_"+p).attr("covered");)p+=1;k=p-d}if("up"===i){k=b;for(var r=a-2;0<=r&&"no"===d3.select("#s_"+r+"_"+b).attr("covered");)r-=1;j=r+1}if("down"===i){k=b;for(var s=a+g-1+2;s<c&&"no"===d3.select("#s_"+s+"_"+b).attr("covered");)s+=1;j=s-g}if("left"===i||"right"===i)for(var t=0;t<d;t++)m.push([a,b+t]),n.push([j,k+t]);if("up"===i||"down"===i)for(var u=0;u<g;u++)m.push([a+u,b]),n.push([j+u,k]);return m.forEach(function(a){d3.select("#s_"+a[0]+"_"+a[1]).attr("covered","no")}),n.forEach(function(a){d3.select("#s_"+a[0]+"_"+a[1]).attr("covered","yes")}),d3.select("rect[class=block][posn='"+a+"_"+b+"']").transition().duration(200).attr("x",k*e/c+(f-e)/2+l).attr("y",j*e/c+q/2+l).attr("posn",j+"_"+k).attr("currx",k).attr("curry",j),setTimeout(function(){if(y()){var a=parseInt(d3.select("#target").attr("x"));d3.select("#target").transition().duration(100).attr("x",a+50),setTimeout(function(){alert("Congrats! You win! \uD83C\uDF89")},100)}},500),[j,k]};d3.selectAll("rect[class='block']").on("click",function(a){if(y())return void alert("You have complete this game! Congrats! \uD83C\uDF89");var b=parseInt(d3.select(this).attr("curry")),d=parseInt(d3.select(this).attr("currx"));if("x"===a.direction){var e=d+a.width-1;if((0===d||"yes"===d3.select("#s_"+b+"_"+(d-1)).attr("covered"))&&(e===c-1||"yes"===d3.select("#s_"+b+"_"+(e+1)).attr("covered")))return;var f,g;if(0<d&&"no"===d3.select("#s_"+b+"_"+(d-1)).attr("covered")&&(f=!0),e<c-1&&"no"===d3.select("#s_"+b+"_"+(e+1)).attr("covered")&&(g=!0),f&&g){var h=d3.mouse(this)[0];h>parseInt(d3.select(this).attr("x"))+parseInt(d3.select(this).attr("width"))/2?z(b,d,a.width,a.height,"right"):z(b,d,a.width,a.height,"left")}else f?z(b,d,a.width,a.height,"left"):g&&z(b,d,a.width,a.height,"right")}else{var i=b+a.height-1;if((0===b||"yes"===d3.select("#s_"+(b-1)+"_"+d).attr("covered"))&&(i===c-1||"yes"===d3.select("#s_"+(i+1)+"_"+d).attr("covered")))return;var j,k;if(0<b&&"no"===d3.select("#s_"+(b-1)+"_"+d).attr("covered")&&(j=!0),i<c-1&&"no"===d3.select("#s_"+(i+1)+"_"+d).attr("covered")&&(k=!0),j&&k){var l=d3.mouse(this)[1];l>parseInt(d3.select(this).attr("y"))+parseInt(d3.select(this).attr("height"))/2?z(b,d,a.width,a.height,"down"):z(b,d,a.width,a.height,"up")}else j?z(b,d,a.width,a.height,"up"):k&&z(b,d,a.width,a.height,"down")}})});